<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop | Balenciaga</title>

    <link rel="shortcut icon" href="../images/logos/favicon-48x48.png">

    <meta property="og:images" content="../images/more/ogimage.png">

    <!--css-->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/sample.css">

    <!--js-->
    <script src="../js/main.js"></script>

    <!--Ion-icons-->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <!--Google-icons-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
</head>



<body>
    <header>
        <div class="header flex w-full px-20 py-10 border-b" id="header">
            <div class="menu-icon hidden col-5">
                <div class="w-fit">
                    <span id="open-icon" class="material-symbols-outlined">menu</span>
                    <span id="close-icon" class="material-symbols-outlined">close</span>
                </div>
            </div>

            <div class="menu col-5">
                <ul class="flex justify-start space-x-20">
                    <li class="slideToggle"><a>Shop</a>
                        <div class="subnav flex slideToggleContent">
                            <ul class="col-2 space-y-10">
                                <li>Ready to wear</li>
                                <li><a href="./products.html?category=jackets">Jackets</a></li>
                                <li><a href="./products.html?category=tshirts">T-shirts</a></li>
                                <li><a href="./products.html?category=pants">Pants</a></li>
                                <li><a href="./products.html?category=activewear">Activewear</a></li>
                            </ul>
                            <!-- <ul class="col-2 space-y-10">
                                <li>Shoes</li>
                                <li></li>
                                <li><a href="#">Sneakers</a></li>
                                <li><a href="#">Boots & Derbies</a></li>
                            </ul> -->
                            <ul class="col-2 space-y-10">
                                <li>Bags</li>
                                <!-- <li><a href="#">Bags & totes</a></li> -->
                                <li><a href="./products.html?category=backpacks">Backpacks</a></li>
                            </ul>
                            <!-- <ul class="col-2 space-y-10">
                                <li>Accessories</li>
                                <li></li>
                                <li><a href="#">Sunglasses</a></li>
                                <li><a href="#">Shocks</a></li>
                            </ul> -->
                            <ul class="col-2 space-y-10">
                                <li><a href="./products.html">VIEW ALL</a></li>
                            </ul>
                        </div>
                    </li>

                    <li><a href="./campaign.html">Campaign</a></li>

                    <li class="slideToggle"><a>Explore</a>
                        <div class="subnav flex slideToggleContent">
                            <ul class="col-2 space-y-10">
                                <li>Collections</li>
                                <li><a href="./summer23.html">Summer 23</a></li>
                                <li><a href="./spring23.html">Spring 23</a></li>
                            </ul>
                            <ul class="col-2 space-y-10">
                                <li>History</li>
                                <li><a href="./ristobalbalenciaga.html">Ristóbal Balenciaga</a></li>
                                <li><a href="./demnagvasalia.html">Demna Gvasalia</a></li>
                            </ul>
                        </div>
                    </li>
                    <li><a href="./contactus.html">Contact us</a></li>
                    <li class="hidden"><a href="./login.html">Log in</a></li>
                </ul>
            </div><!--menu-->

            <div class="logo col-2 text-center">
                <a href="../index.html" class="text-15">
                    <span class="font-bold">BALENCIAGA</span>
                </a>
            </div><!--logo-->

            <div class="setting col-5">
                <ul class="flex justify-end space-x-20">
                    <li class="flex dark-light-icon">
                        <span id="light-icon" class="material-symbols-outlined">light_mode</span>
                        <span id="dark-icon" class="material-symbols-outlined">dark_mode</span>
                    </li>
                    <li class="cart slideToggle">
                        <a class="cart-icon flex"><span class="material-symbols-outlined">work</span><span id="countInCart" class="flex">0</span></a>
                        <div class="subnav slideToggleContent">
                            <div class="cart-item-list">
                            </div><!--cart-item-list-->
                            <div class="cart-item flex cart-subtotal">
                                <h6>Subtotal </h6>
                                <h6>$ <span id="cartSubtotal">0</span></h6>
                            </div>
                            <div class="cart-viewdetail">
                                <a href="./cart.html">View details</a>
                            </div>
                        </div>
                    </li>
                    <li class="setting-login"><a href="./login.html">Log in</a></li>
                </ul>
            </div><!--setting-->
        </div>
    </header>



    <div class="container">
        <div class="products-content1">
            <div class="background-image">
                <picture>
                    <source media="(max-width:768px)" srcset="../images/backgrounds/background-shop2.png">
                    <img src="../images/backgrounds/background-shop.png" alt="">
                  </picture>
                <div class="caption w-full text-center p-20">
                    <h2 class="category text-white uppercase">VIEW ALL</h2>
                </div>
            </div>
        </div><!--products-content1-->

        <div class="products-content2 p-20">
            <div class="product-list w-full grid grid-cols-4 gap-20 maxw-1024-grid-cols-3 maxw-768-grid-cols-2">
            </div><!--products-list-->
        </div><!--products-content2-->


        
        <div class="filter green-button flex fixed border text-0875 space-x-5 px-10">
            <p>Filter</p>
            <span class="material-symbols-outlined">tune</span>
        </div>
        <div class="filter-panel col-5">
            <div class="filter-title flex uppercase border-b font-bold">
                <p>Filter</p>
                <span id="close-filter" class="p-20 material-symbols-outlined">close</span>
            </div>

            <div>
                <p class="px-10 mt-20 mb-0 text-center uppercase">Size</p>
                <div class="grid grid-cols-6 gap-10 maxw-1024-grid-cols-4 p-10">
                    <p class="filter-item">1</p>
                    <p class="filter-item">2</p>
                    <p class="filter-item">3</p>
                    <p class="filter-item">4</p>
                    <p class="filter-item">XS</p>
                    <p class="filter-item">S</p>
                    <p class="filter-item">M</p>
                    <p class="filter-item">L</p>
                    <p class="filter-item">XL</p>
                    <p class="filter-item">U</p>
                </div>
            </div>
        </div>
    </div><!--container-->



    <footer class="border-t">
        <div class="footer grid grid-cols-5 gap-20px px-20 py-40">
            <div class="slideToggle">
                <h6 class="uppercase mb-10">Newsletter</h6>
                <ul class="slideToggleContent space-y-5">
                    <li><a href="#">Subscribe to our newsletter</a></li>
                </ul>
            </div>
            <div class="slideToggle">
                <h6 class="uppercase mb-10">Client services</h6>
                <ul class="slideToggleContent space-y-5">
                    <li><a href="#">FAQ</a></li>
                    <li><a href="#">Track order</a></li>
                    <li><a href="#">Returns</a></li>
                    <li><a href="#">Delivery</a></li>
                    <li><a href="#">Payment</a></li>
                </ul>
            </div>
            <div class="slideToggle">
                <h6 class="uppercase mb-10">The company</h6>
                <ul class="slideToggleContent space-y-5">
                    <li><a href="#">Careers</a></li>
                    <li><a href="#">Careers - Design</a></li>
                    <li><a href="#">Legal</a></li>
                    <li><a href="#">Privacy policy and cookies</a></li>
                    <li><a href="#">World food programme</a></li>
                </ul>
            </div>
            <div class="slideToggle">
                <h6 class="uppercase mb-10">Connect</h6>
                <ul class="slideToggleContent space-y-5">
                    <li><a href="#">Facebook</a></li>
                    <li><a href="#">Instagram</a></li>
                    <li><a href="#">Youtube</a></li>
                </ul>
            </div>
            <div class="slideToggle">
                <h6 class="uppercase mb-10">Boutiques</h6>
                <ul class="slideToggleContent space-y-5">
                    <li><a href="#">Find a store nearby</a></li>
                    <li><a href="#">Language: English</a></li>
                </ul>
            </div>
        </div><!--footer-->

        <div class="w-full border-t text-center p-10">
            <p>© Balenciaga</p>
        </div>
    </footer>



    <script>
        //get category in URL
        const categoryURL = new URLSearchParams(window.location.search).get("category");

        // display category in <h2>
        document.querySelector(".category").innerHTML = (categoryURL || "view all");

        const categories = {
            "jackets": "j",
            "tshirts": "s",
            "pants": "p",
            "activewear": "a",
            "backpacks": "b"
        }

        //if cayegoryURl is null => view all
        category = categories[categoryURL];
        if(category == -1) {
            category = "view all";
        }

        
        var arrFilter = [];
        const renderProducts = async (arrFilter) => {
            let uri = "http://localhost:3000/products";
    
            if(category) {
                uri += `?id_like=${category}`;
            }

            const res = await fetch(uri);
            var products = await res.json();

            if(arrFilter != "") {
                products = products.filter(function (element) {
                    return element.available.some(function (ava) {
                        if(arrFilter.indexOf(ava.size.toString()) > -1) return true;
                        else return false;
                    });
                });
            }

            let productList = "";
            
            products.forEach(product => {
                productList += `
                    <div class="card text-center">
                        <a href="./productdetail.html?id=${product.id}">
                            <figure>
                                <img src="../images/products/${product.id}-1.png" alt="">
                            </figure>
                            <div class="mt-10">
                                <p>${product.name}</p>
                                <p>$ ${product.price}</p>
                            </div>
                        </a>
                    </div> 
                `;
            })

            //display products
            document.querySelector(".product-list").innerHTML = productList;
        }

        window.addEventListener("DOMContentLoaded", () => renderProducts(arrFilter));



        //filter
        //open filter panel
        document.querySelectorAll(".filter, #close-filter").forEach(item => {
            item.addEventListener("click", function() {
                document.querySelector(".filter-panel").classList.toggle("active-filter");
            })
        })

        //filter
        document.querySelectorAll(".filter-item").forEach(item => {
            item.addEventListener("click", function() {
                this.classList.toggle("active-filter-item");
                //get size and add or remove from arrFilter
                var value = this.innerText;
                addOrRemove(arrFilter, value);

                renderProducts(arrFilter);
            })
        })

        function addOrRemove(array, value) {
            var index = array.indexOf(value);

            if (index === -1) array.push(value);
            else array.splice(index, 1);
        }
    </script>
</body>
</html>